function title(a){return"mp"==a?"Multiplayer ":"wz"==a?"Warzone ":"cw"==a?"Cold war ":void 0}function capitalize(a){return a.charAt(0).toUpperCase()+a.slice(1)}function chart(a){var t=window.location.href+"api/chart/"+a+"/",e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState){var t=JSON.parse(e.responseText),l=["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","rgba(22, 212, 203, 1)"],i=["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)","rgba(22, 212, 203, 0.2)"],s={responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}},o={};for(mode in"week"==a&&(document.getElementById("chart").innerHTML='<ul class="nav nav-tabs flex" role="tablist"><li class="nav-item"><a class="nav-link active" href="#chart_week" data-bs-toggle="tab" role="tab">Week</a></li><li class="nav-item"><a class="nav-link" href="#chart_lifetime" onclick="chart(&#039;lifetime&#039;); this.onclick=null;" data-bs-toggle="tab" role="tab">Lifetime</a></li></ul><div class="tab-content"><div class="tab-pane active" id="chart_week" role="tabpanel"></div><div class="tab-pane" id="chart_lifetime" role="tabpanel"></div></div>'),t)o[mode]=[],document.getElementById("chart_"+a).innerHTML+='<h4 class="tab-title"><a href="'+window.location.href+"api/chart/"+a+'/" target="_blank">'+title(mode)+'</a></h4><div class="chart"><canvas id="chart_'+a+"_"+mode+'"></canvas></div>';for(mode in t){for(user in t[mode].players)gamedata={label:user,data:t[mode].players[user],backgroundColor:i,borderColor:l,borderWidth:1},o[mode].push(gamedata);var n=document.getElementById("chart_"+a+"_"+mode).getContext("2d");new Chart(n,{type:"line",data:{labels:t[mode].dates,datasets:o[mode]},options:s})}}},e.open("GET",t,!0),e.send()}function get(a,t,e,l,s){var o=e.replace("#","%23");if("wz"==a&&""==s){var n="Place",r="username",d="teamPlacement",c="totalXp";"all"!=e?p():b(),_()}else if("mp"==a&&""==s){n="Result",r="username",d="result",c="totalXp";"all"!=e?p():b(),_()}else if("cw"==a&&""==s){n="Result",r="user",d="result",c="xpAtEnd";"all"!=e?p():b(),_()}else if("wz"==a&&"lifetime"==s){var h="DistanceTraveled";v()}else if("mp"==a&&"lifetime"==s){h="Accuracy";v()}else if("cw"==a&&"lifetime"==s){h="Accuracy";v()}if("stats"==s){var m=window.location.href+"api/"+a+"/stats/1/"+o+"/-id/",u=new XMLHttpRequest;u.onreadystatechange=function(){if(4==u.readyState){var t=JSON.parse(u.responseText);document.getElementById("stats_"+a+l).innerHTML='<h5><a href="'+window.location.href+"api/"+a+"/stats/1/"+o+'/-id/" target="_blank">Summary stats</a> for last 20 matches:</h5>'+f(t.data[0].summary_stats),document.getElementById("time_"+a+l).innerHTML="All time Stats on ["+new Date(t.data[0].time_all_summary_stats).toLocaleString("en-GB")+"]",document.getElementById("stats_all_"+a+l).innerHTML=f(t.data[0].all_summary_stats),"mp"==a&&(document.getElementById("add_stats_all_"+a+l).innerHTML="<h5>Additional stats:</h5>"+f(t.data[0].additional_all_stats))}},u.open("GET",m,!0),u.send()}function p(){document.getElementById("page_"+a+"_"+l).innerHTML='<ul class="nav nav-tabs flex" role="tablist"><li class="nav-item"><a class="nav-link active" href="#table_'+a+"_"+l+'" data-bs-toggle="tab" role="tab">Table</a></li><li class="nav-item"><a class="nav-link" href="#stats_'+a+"_"+l+'" onclick="get(&#039;'+a+"&#039;, &#039;&#039;, &#039;"+e+"&#039;, &#039;"+l+'&#039;, &#039;stats&#039;, &#039;-timestamp&#039;); this.onclick=null;" data-bs-toggle="tab" role="tab">Stats</a></li></ul><div class="tab-content"><div class="tab-pane active" id="table_'+a+"_"+l+'" role="tabpanel"><ul class="nav nav-tabs flex" role="tablist"><li class="nav-item"><a class="nav-link active" href="#last50_'+a+"_"+l+'" data-bs-toggle="tab" role="tab">Last 50</a></li><li class="nav-item"><a class="nav-link" href="#lifetime_'+a+"_"+l+'" onclick="get(&#039;'+a+"&#039;, &#039;all&#039;, &#039;"+e+"&#039;, &#039;"+l+'&#039;, &#039;lifetime&#039;, &#039;-timestamp&#039;); this.onclick=null;" data-bs-toggle="tab" role="tab">Lifetime</a></li></ul><div class="tab-content"><div class="tab-pane active" id="last50_'+a+"_"+l+'" role="tabpanel"></div><div class="tab-pane" id="lifetime_'+a+"_"+l+'" role="tabpanel"></div></div></div><div class="tab-pane" id="stats_'+a+"_"+l+'" role="tabpanel"><p id="stats_'+a+l+'"></p><h5 id="time_'+a+l+'"></h5><p id="stats_all_'+a+l+'"></p><p id="add_stats_all_'+a+l+'"></p></div></div>'}function b(){document.getElementById("page_"+a).innerHTML='<ul class="nav nav-tabs flex" role="tablist"><li class="nav-item"><a class="nav-link active" href="#'+a+'_" data-bs-toggle="tab" role="tab">Table</a></li></ul><div class="tab-content"><ul class="nav nav-tabs flex" role="tablist"><li class="nav-item"><a class="nav-link active" href="#last50_'+a+'_" data-bs-toggle="tab" role="tab">Last 50</a></li><li class="nav-item"><a class="nav-link" href="#lifetime_'+a+'_" onclick="get(&#039;'+a+"&#039;, &#039;all&#039;, &#039;"+e+"&#039;, &#039;"+l+'&#039;, &#039;lifetime&#039;, &#039;-timestamp&#039;); this.onclick=null;" data-bs-toggle="tab" role="tab">Lifetime</a></li></ul><div class="tab-content"><div class="tab-pane active" id="last50_'+a+'_" role="tabpanel"></div><div class="tab-pane" id="lifetime_'+a+'_" role="tabpanel"></div></div></div>'}function _(){document.getElementById("last50_"+a+"_"+l).innerHTML='<h4 class="tab-title"><a href="'+window.location.href+"api/"+a+"/raw/"+t+"/"+o+'/-timestamp/" target="_blank">'+title(a)+l+' [50]</a></h4><table id="last50_table_'+a+"_"+l+'" style="width:100%" class="table table-hover"><thead><tr><th></th><th>Played</th><th>Player</th><th>Duration</th><th>Kills</th><th>Deaths</th><th>K/D</th><th>'+n+"</th><th>TotalXp</th></tr></thead></table>";var e=$("#last50_table_"+a+"_"+l).DataTable({ajax:{method:"GET",url:window.location.href+"api/"+a+"/raw/"+t+"/"+o+"/-timestamp/",dataType:"json"},columns:[{className:"details-control",orderable:!1,data:null,defaultContent:""},{data:"timestamp",render:function(a,t){return"sort"===t?a:new Date(a).toLocaleString("en-GB")}},{data:r,render:function(t){return"cw"==a?t.split("#")[0]:t}},{data:"duration"},{data:"kills"},{data:"deaths"},{data:"kdRatio"},{data:d},{data:c}],order:[[1,"desc"]],searching:!1});$("#last50_table_"+a+"_"+l+" tbody").on("click","td.details-control",function(){var t=$(this).closest("tr"),l=e.row(t);l.child.isShown()?(l.child.hide(),t.removeClass("shown")):(l.child(function(a,t){if("mp"==t||"wz"==t){count=0;var e=["primaryWeapon","secondaryWeapon","tactical","lethal"];for(loadout in final_loadout_html="",a.loadout){function l(t){var e=a.loadout[loadout][t].label;if(null!=e&&""!=e||(e=a.loadout[loadout][t].name),"none"!=e){if(loadout_html+="<li><a>"+e+"</a><ul>","primaryWeapon"==t||"secondaryWeapon"==t){for(attachments="",i=0;i<5;i++)null!=a.loadout[loadout][t].attachments[i].name&&"none"!=a.loadout[loadout][t].attachments[i].name&&(attachments+="<li><a>"+(i+1)+" "+a.loadout[loadout][t].attachments[i].name+"</a></li>");""!=attachments&&(loadout_html+="<li><a>Attachments</a><ul>"+attachments+"</ul></li>")}loadout_html+="</ul></li>"}}function o(){for("mp"==t&&(perks_name="label"),"wz"==t&&(perks_name="name"),perks_html="",obj_perks="",obj_extraPerks="",i=0;i<3;i++)"null"!=a.loadout[loadout].perks[i][perks_name].replace(/\s|specialty_/g,"")&&null!=a.loadout[loadout].perks[i][perks_name]&&(obj_perks+="<li><a>"+a.loadout[loadout].perks[i][perks_name].replace(/\s|specialty_/g,"")+"</a></li>");for(i=0;i<3;i++)null!=a.loadout[loadout].extraPerks[i][perks_name]&&"null"!=a.loadout[loadout].extraPerks[i][perks_name]&&(obj_extraPerks+="<li><a>"+a.loadout[loadout].extraPerks[i][perks_name].replace(/\s|specialty_/g,"")+"</a></li>");return""!=obj_perks&&(""!=obj_extraPerks&&(obj_perks+="<li><a>ExtraPerks</a><ul>"+obj_extraPerks+"</ul></li>"),perks_html+="<li><a>Perks</a><ul>"+obj_perks+"</ul></li>"),""==obj_perks&&(perks_html=""),perks_html}function n(){return"mp"==t?"<li><a>Killstreaks</a><ul><li><a>"+a.loadout[loadout].killstreaks[0].label+"</a></li><li><a>"+a.loadout[loadout].killstreaks[1].label+"</a></li><li><a>"+a.loadout[loadout].killstreaks[2].label+"</a></li></ul></li>":""}loadout_html="",count+=1,e.forEach(l),final_loadout_html+="<li><a>"+count+"</a><ul>"+loadout_html+o()+n()+"</ul></li>"}var r='<img src="/media/'+t+"_maps/"+a.map.replace(/\s|'|-|_rm/g,"")+'.gif" alt="Avatar" class="table-image"><div class="table-center"><div class="grid-container-table"><ul class="dropdown"><li><a>Loadouts</a><ul>'+final_loadout_html+"</ul></li></ul>"+function(){if("mp"==t){try{for(weapons in obj_stats="",a.weaponStats)"none"!=weapons&&0!=a.weaponStats[weapons].startingWeaponXp&&(obj_stats+="<li><a>"+weapons+"</a><ul><li><a>Hits: "+a.weaponStats[weapons].hits+"</a></li><li><a>Kills: "+a.weaponStats[weapons].kills+"</a></li><li><a>Deaths: "+a.weaponStats[weapons].deaths+"</a></li><li><a>Headshots: "+a.weaponStats[weapons].headshots+"</a></li><li><a>Shots: "+a.weaponStats[weapons].shots+"</a></li><li><a>Starting WeaponXp: "+a.weaponStats[weapons].startingWeaponXp+"</a></li><li><a>XpEarned: "+a.weaponStats[weapons].xpEarned+"</a></li></ul></li>");weapons_html='<ul class="dropdown"><li><a>Weapon stats</a><ul>'+obj_stats+"</ul></li></ul>"}catch(a){weapons_html=""}return""==obj_stats&&(weapons_html=""),weapons_html}return""}()}for(s in a)if(!["id","user","username","uno","clantag","timestamp","duration","kills","deaths","kdRatio","result","place","totalXp","loadout","weaponStats"].includes(s)&&null!=a[s]&&0!=a[s])try{r+='<div class="grid-item-table">'+capitalize(s.replace(/objective|Br|Medal|ScoreSs/g,""))+": "+a[s]+"</div>"}catch(a){r+=a}return r+"</div></div>"}(l.data(),a),"table-container").show(),t.addClass("shown"))})}function v(){document.getElementById("lifetime_"+a+"_"+l).innerHTML='<h4 class="tab-title"><a href="'+window.location.href+"api/"+a+"/table/all/"+o+'/-timestamp/" target="_blank">'+title(a)+l+' [all]</a></h4><table id="lifetime_table_'+a+"_"+l+'" style="width:100%" class="table table-hover"><thead><tr><th>Played</th><th>Player</th><th>Kills</th><th>Deaths</th><th>K/D</th><th>DamageDone</th><th>LongesStreak</th><th>Headshots</th><th>'+h+"</th><th>TotalXp</th></tr></thead></table>";$("#lifetime_table_"+a+"_"+l).DataTable({ajax:{method:"GET",url:window.location.href+"api/"+a+"/table/"+t+"/"+o+"/-timestamp/",dataType:"json"},columns:[{data:"Played"},{data:"Player"},{data:"Kills"},{data:"Deaths"},{data:"K/D"},{data:"DamageDone"},{data:"LongesStreak"},{data:"Headshots"},{data:h},{data:"TotalXp"}],order:[[0,"desc"]],searching:!1})}function f(a){var t,e='<div class="grid-container">';for(s in a)if("title"!=s)try{e+='<div class="grid-item" style="background-color: rgb('+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+',0.1);">'+capitalize(s.replace(/objective|Br|Medal|Score|Ss/g,"").replace(/([A-Z])/g," $1"))+": "+((t=a[s])%1!=0&&(t=t.toFixed(2)),t)+"</div>"}catch(a){e+=a}return e+"</div>"}}